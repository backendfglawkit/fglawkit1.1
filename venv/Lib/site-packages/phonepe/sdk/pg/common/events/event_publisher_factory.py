from phonepe.sdk.pg.common.configs.merchant_config import MerchantConfig
from phonepe.sdk.pg.common.events.publisher.event_publisher import EventPublisher
from phonepe.sdk.pg.common.events.event_queue_handler import EventQueueHandler
from phonepe.sdk.pg.common.events.publisher.default_event_publisher import DefaultEventPublisher
from phonepe.sdk.pg.common.http_client_modules.api_requestor import ApiRequestor


class EventPublisherFactory:

    def __init__(self, merchant_config: MerchantConfig, queue_handler: EventQueueHandler, event_sender: ApiRequestor):
        self.actual_event_publisher = EventPublisher(merchant_config=merchant_config, queue_handler=queue_handler,
                                                     event_sender=event_sender)
        self.non_sending_event_publisher = DefaultEventPublisher()

    def get_event_publisher(self, should_publish_events: bool):
        if should_publish_events:
            return self.actual_event_publisher
        return self.non_sending_event_publisher
