from unittest import TestCase

from phonepe.sdk.pg.common.events.event_queue_handler import EventQueueHandler


class TestEventQueueHandler(TestCase):

    def test_event_put(self):
        queue_handler = EventQueueHandler()
        queue_handler.clear_queue()

        test_data = "test_data"
        queue_handler.put(test_data)
        queue_data = queue_handler.get()
        assert test_data == queue_data

    def test_clear_queue(self):
        queue_handler = EventQueueHandler()
        test_data = "test"
        for _ in range(10):
            queue_handler.put(test_data)
        queue_handler.write_data_to_queue()
        queue_handler.clear_queue()
        expected_data = None
        assert expected_data == queue_handler.get()
